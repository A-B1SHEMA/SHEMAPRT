{% extends "layout.html" %}
{% block content %}
<h2>Apartment Overview</h2>

{% for apt in apartments %}
<div style="border:1px solid #ccc; padding:10px; margin-bottom:20px; width:400px;">
    <form method="POST" action="{{ url_for('update_booking') }}">
        <p><strong>Name:</strong> {{ apt.name }}</p>
        <p><strong>Type:</strong> {{ apt.type }}</p>

        <p>
          <strong>Status:</strong>
          <select name="status" style="background-color:
            {% if apt.status=='Available' %}lightgreen
            {% elif apt.status=='Reserved' %}lightcoral
            {% else %}orange{% endif %};">
            <option value="Available" {% if apt.status=="Available" %}selected{% endif %}>Available</option>
            <option value="Reserved" {% if apt.status=="Reserved" %}selected{% endif %}>Reserved</option>
            <option value="On Hold" {% if apt.status=="On Hold" %}selected{% endif %}>On Hold</option>
          </select>
        </p>

        <p><strong>Start Date:</strong> <input type="date" name="start_date" required></p>
        <p><strong>End Date:</strong> <input type="date" name="end_date" required></p>
        <p><strong>Price Paid:</strong> <input type="number" name="price" min="0" required></p>
        <p><strong>Security Deposit:</strong> <input type="number" name="deposit" min="0" required></p>

        <input type="hidden" name="apt_id" value="{{ apt.id }}">
        <button type="submit">Save Booking</button>
    </form>

    {% if apt.bookings %}
    <div style="margin-top:10px; padding:5px; border-top:1px solid #aaa;">
        <strong>Existing Bookings:</strong>
        <ul>
            {% for b in apt.bookings %}
                <li>
                    {{ b.start }} â†’ {{ b.end }} : {{ b.status }} | ${{ b.price }} | Deposit ${{ b.deposit }}
                </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}
</div>
{% endfor %}
{% endblock %}

